# Wallet

![Javacode Wallet](docs/images/wallet.webp)

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ—à–µ–ª—å–∫–∞–º–∏. –¢–µ—Å—Ç–æ–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ, –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω–æ–µ –¥–ª—è –∫–æ–º–ø–∞–Ω–∏–∏ [Javacode](https://javacode.ru/).

> [!IMPORTANT]
> –•–æ–¥ —Ä–∞–±–æ—Ç—ã, –≤–Ω–µ—Å—ë–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏—è –∫ –∑–∞–¥–∞–Ω–∏—é [–æ–ø–∏—Å–∞–Ω—ã –≤ –∫–æ–Ω—Ü–µ](#—Ö–æ–¥-—Ä–∞–±–æ—Ç—ã) –¥–∞–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- –°–æ–∑–¥–∞–Ω–∏–µ –∏ —É–¥–∞–ª–µ–Ω–∏–µ –∫–æ—à–µ–ª—å–∫–∞
- –ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –∏ —Å–Ω—è—Ç–∏–µ —Å—Ä–µ–¥—Å—Ç–≤
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–ª–∞–Ω—Å–∞
- –ü—Ä–æ—Å–º–æ—Ç—Ä —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö –∫–æ—à–µ–ª—å–∫–æ–≤ (—Å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π)

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- RESTful API
- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è —Å Docker –∏ Docker Compose
- –û—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –≤ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ–π —Å—Ä–µ–¥–µ
- –ß—Ç–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å—Ä–µ–¥—ã –∏–∑ —Ñ–∞–π–ª–∞
- –ë–∞–∑–æ–≤–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- –ú–∏–≥—Ä–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö —Å [`goose`](https://github.com/pressly/goose)
- –¢–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö —Å [`sqlc`](https://github.com/sqlc-dev/sqlc)
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω —Ä–æ—É—Ç–µ—Ä –∏–∑ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ `net/http`
- –õ–∏–Ω—Ç–∏–Ω–≥ —Å GitHub Actions
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã (Graceful shutdown)

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Go (–≤–µ—Ä—Å–∏—è 1.22 –∏ –≤—ã—à–µ)
- Docker

## –ù–∞—á–∞–ª–æ —Ä–∞–±–æ—Ç—ã

### –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

–°–Ω–∞—á–∞–ª–∞ –∫–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:

```bash
git clone https://github.com/chtozamm/javacode-wallet.git
cd javacode-wallet
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å—Ä–µ–¥—ã

–í –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ —Å–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ —Å—Ä–µ–¥—ã:

```env
DB_URL="postgres://javacode:secret@postgres:5432/wallet"
PORT="8080"
AUTH_USERNAME="javacode"
AUTH_PASSWORD="secret"
```

### –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

–ó–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã —Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º –∏ —Å–µ—Ä–≤–µ—Ä–æ–º PostgreSQL, –∏—Å–ø–æ–ª—å–∑—É—è **Docker Compose**:

```bash
docker compose up -d
```

### –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π

–ü—Ä–∏–º–µ–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö:

```bash
goose postgres -dir sql/schema postgres://javacode:secret@localhost:5432/wallet up
```

### –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ—à–µ–ª—å–∫–∞

–°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –∫–æ—à–µ–ª—ë–∫ –∏ –∑–∞–ø–∏—à–∏—Ç–µ –µ–≥–æ ID –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é:

```bash
wallet_id=$(curl -s http://localhost:8080/api/v1/wallets -X POST)
echo $wallet_id
```

### –ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞

–ü–æ–ø–æ–ª–Ω–∏—Ç–µ –±–∞–ª–∞–Ω—Å –∫–æ—à–µ–ª—å–∫–∞ –Ω–∞ 500 –µ–¥–∏–Ω–∏—Ü:

```bash
curl http://localhost:8080/api/v1/wallets/$wallet_id -X POST \
	-H "Content-Type: application/json" \
	-d '{"operation_type": "deposit", "amount": 500}'
```

### –°–Ω—è—Ç–∏–µ —Å—Ä–µ–¥—Å—Ç–≤

–°–Ω–∏–º–∏—Ç–µ —Å—Ä–µ–¥—Å—Ç–≤–∞ –≤ —Ä–∞–∑–º–µ—Ä–µ 170 –µ–¥–∏–Ω–∏—Ü —Å–æ —Å—á—ë—Ç–∞ –∫–æ—à–µ–ª—å–∫–∞:

```bash
curl http://localhost:8080/api/v1/wallets/$wallet_id -X POST \
	-H "Content-Type: application/json" \
	-d '{"operation_type": "withdraw", "amount": 170}'
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–ª–∞–Ω—Å–∞

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –±–∞–ª–∞–Ω—Å –∫–æ—à–µ–ª—å–∫–∞:

```bash
curl http://localhost:8080/api/v1/wallets/$wallet_id
```

### –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∫–æ—à–µ–ª—å–∫–æ–≤

–ü–æ–ª—É—á–∏—Ç–µ —Å–ø–∏—Å–æ–∫ –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã—Ö –∫–æ—à–µ–ª—å–∫–æ–≤ (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è basic auth):

```bash
curl http://localhost:8080/api/v1/wallets -u javacode:secret
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- Go
- Docker & Docker Compose
- PostgreSQL
- [`sqlc`](https://github.com/sqlc-dev/sqlc) –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –∫–æ–¥–∞ –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö –∏–∑ SQL-–∑–∞–ø—Ä–æ—Å–æ–≤
- [`goose`](https://github.com/pressly/goose) –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏—è–º–∏

## –•–æ–¥ —Ä–∞–±–æ—Ç—ã

–í —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å —É–∫–∞–∑–∞–Ω–∏–µ–º:

> –í—Å–µ –≤–æ–∑–Ω–∏–∫–∞—é—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã –ø–æ –∑–∞–¥–∞–Ω–∏—é —Ä–µ—à–∞—Ç—å —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ, –ø–æ —Å–≤–æ–µ–º—É —É—Å–º–æ—Ç—Ä–µ–Ω–∏—é.

–ú–Ω–æ—é –±—ã–ª–∏ –≤–Ω–µ—Å–µ–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –¥–ª—è —Å–æ–±–ª—é–¥–µ–Ω–∏—è –ª—É—á—à–∏—Ö –ø—Ä–∞–∫—Ç–∏–∫:

- –§–∞–π–ª `config.env` –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω –≤ `.env`
- –ü–æ–ª–µ –≤ –∑–∞–ø—Ä–æ—Å–µ `valletId` –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–æ –≤ `wallet_id`
- –ü–æ–ª–µ –≤ –∑–∞–ø—Ä–æ—Å–µ `operationType` –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–æ –≤ `operation_type`
- –í–º–µ—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø—É—Ç–∏ `/api/v1/wallet` –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ —Å–æ–≤–µ—Ä—à–µ–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –∏ –æ–∂–∏–¥–∞–Ω–∏—è —Å–µ—Ä–≤–µ—Ä–æ–º –ø–æ–ª—è `wallet_id` –≤ —Ç–µ–ª–µ –∑–∞–ø—Ä–æ—Å–∞, —è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª `/api/v1/wallets/{wallet_id}`

–í –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –±—ã–ª–∏ —Å–æ–∑–¥–∞–Ω—ã –¥–≤–µ —Ç–∞–±–ª–∏—Ü—ã: `wallets` –∏ `operations`. –ü—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä –æ–¥–Ω–æ–π –∏–∑ –æ–ø–µ—Ä–∞—Ü–∏–π (**deposit**/**withdraw**), –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è: –≤ —Ç–∞–±–ª–∏—Ü—É `operations` –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –Ω–æ–≤–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è, –∑–∞—Ç–µ–º –≤ —Ç–∞–±–ª–∏—Ü–µ `wallets` –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –±–∞–ª–∞–Ω—Å –∫–æ—à–µ–ª—å–∫–∞. –í —Å–ª—É—á–∞–µ, –µ—Å–ª–∏ –Ω–∞ –æ–¥–Ω–æ–º –∏–∑ —à–∞–≥–æ–≤ –≤–æ–∑–Ω–∏–∫–ª–∞ –æ—à–∏–±–∫–∞, –≤—Å—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –æ—Ç–º–µ–Ω—è–µ—Ç—Å—è, –∏ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ –∏—Å—Ö–æ–¥–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –¥–æ –Ω–∞—á–∞–ª–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏.

–ü–æ–º–∏–º–æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–≤—É—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ —Å–æ–≤–µ—Ä—à–µ–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –∏ –≤—ã–≤–æ–¥ –±–∞–ª–∞–Ω—Å–∞, –º–Ω–æ—é –±—ã–ª–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã:

- `POST /api/v1/wallets` ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ –∫–æ—à–µ–ª—å–∫–∞
- `GET /api/v1/wallets` ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö –∫–æ—à–µ–ª—å–∫–æ–≤
- `DELETE /api/v1/wallets/{wallet_id}` ‚Äî —É–¥–∞–ª–µ–Ω–∏–µ –∫–æ—à–µ–ª—å–∫–∞
- `GET /api/v1/healthz` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–µ—Ä–≤–µ—Ä–∞ –∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

> [!TIP]
> –ü–æ–ª–Ω—ã–π –æ–±–∑–æ—Ä API —è –Ω–∞–ø–∏—Å–∞–ª –≤ [`docs/api.md`](docs/api.md).

–°–µ—Ä–≤–µ—Ä –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω –Ω–∞ –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –ø—Ä–∏ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º–æ–π –Ω–∞–≥—Ä—É–∑–∫–µ: **0 –æ—Ç–∫–∞–∑–æ–≤ –ø—Ä–∏ 1000 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —Å–µ–∫—É–Ω–¥—É**. –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –±—ã–ª–∞ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ `ab`, —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω—ã –≤ —Ñ–∞–π–ª–µ [`docs/benchmark.md`](/docs/benchmark.md).

–ö–æ–¥ –ø—Ä–æ–≤–µ—Ä–µ–Ω —Å –ø–æ–º–æ—â—å—é –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ `go vet`, `staticcheck`, `gosec`.

–í Figma –±—ã–ª —Å–æ–∑–¥–∞–Ω –ª–æ–≥–æ—Ç–∏–ø, —á—Ç–æ–±—ã –¥–æ–±–∞–≤–∏—Ç—å —Ä–∞–±–æ—Ç–µ –∫—Ä–∞—Å–æ–∫ üòä

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–°–ø–∞—Å–∏–±–æ –∑–∞ –≤–Ω–∏–º–∞–Ω–∏–µ! –° —É–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏–µ–º –≥–æ—Ç–æ–≤ –æ—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –ª—é–±—ã–µ –≤–æ–ø—Ä–æ—Å—ã –∏ –æ–±—Å—É–¥–∏—Ç—å –≤–æ–∑–º–æ–∂–Ω—ã–µ –¥–æ—Ä–∞–±–æ—Ç–∫–∏.
